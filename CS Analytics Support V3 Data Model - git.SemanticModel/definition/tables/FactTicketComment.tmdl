table FactTicketComment
	lineageTag: 7276b4f0-5231-43ed-bc64-4cdb7eb71afb

	column comment_id
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: 0d05a5ce-e4c4-45c2-aac4-bbccf9ffce75
		summarizeBy: none
		sourceColumn: comment_id

		changedProperty = IsHidden

		annotation SummarizationSetBy = User

	column ticket_id
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: 76c9ca86-30f6-4027-ac7a-450d56b8cbb1
		summarizeBy: none
		sourceColumn: ticket_id

		changedProperty = IsHidden

		annotation SummarizationSetBy = User

	column author_zendesk_id
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: 2fc51fff-a82b-4cb7-a576-ecdb71a7c058
		summarizeBy: none
		sourceColumn: author_zendesk_id

		changedProperty = IsHidden

		annotation SummarizationSetBy = User

	column author_handle
		dataType: string
		lineageTag: f43b0c78-fbe1-47a3-9c9b-28d24aa21037
		summarizeBy: none
		sourceColumn: author_handle

		annotation SummarizationSetBy = Automatic

	column 'Ticket Comment At'
		dataType: dateTime
		formatString: General Date
		lineageTag: a0e57701-e74a-4391-a9e4-fda3e0cdefaa
		summarizeBy: none
		sourceColumn: Ticket Comment At

		changedProperty = IsHidden

		annotation SummarizationSetBy = Automatic

	column 'Ticket Comment Date'
		dataType: dateTime
		isHidden
		formatString: General Date
		lineageTag: 6ae173bb-99c1-44e3-a009-f843a6e25e6d
		summarizeBy: none
		sourceColumn: Ticket Comment Date

		changedProperty = IsHidden

		annotation SummarizationSetBy = Automatic

	column assignee_zendesk_id
		dataType: int64
		formatString: 0
		lineageTag: 12475fba-d237-4d1e-a1f2-5a5f08faca56
		summarizeBy: sum
		sourceColumn: assignee_zendesk_id

		annotation SummarizationSetBy = Automatic

	column 'Is Commented by Assignee'
		dataType: int64
		formatString: 0
		lineageTag: 5f5bd52b-4962-472c-979f-7da628c5d6d6
		summarizeBy: sum
		sourceColumn: Is Commented by Assignee

		annotation SummarizationSetBy = Automatic

	column 'Comment Count' =
			
			VAR TicketID = FactTicketComment[ticket_id]
			RETURN COUNTROWS(FILTER(FactTicketComment, FactTicketComment[ticket_id] = TicketID))
		formatString: 0
		lineageTag: 9a441186-7adb-4395-9b67-15f373596e99
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column 'is public comment' = if(RELATED(DimTicketComment[Is Public Comment]) = TRUE,1,0)
		lineageTag: ad3b9719-a23f-4df0-a097-cf4788812635
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column 'Public Comments' = ```
			
			VAR TicketID = FactTicketComment[ticket_id]
			RETURN 
			    COUNTROWS(
			        FILTER(
			            FactTicketComment,
			           FactTicketComment[ticket_id] = TicketID &&
			            RELATED(DimTicketComment[Is Automated Comment]) = FALSE &&
			            RELATED(DimTicketComment[Is Public Comment]) = TRUE
			        )
			    )
			
			```
		lineageTag: 971262f3-4196-4a08-a0f9-6acb3a49351e
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	partition FactTicketComment = m
		mode: import
		source =
				let
				    Source = AzureDataExplorer.Contents("gh-analytics.eastus.kusto.windows.net", "service_cs_analytics", "let comment_fact = database(""service_cs_analytics"").supportv3_ticket_comment_fact;#(lf)let user_dim = database(""service_cs_analytics"").supportv3_user_dim;#(lf)let ticket_fact = database(""service_cs_analytics"").supportv3_ticket_fact;#(lf)#(lf)comment_fact#(lf)| where is_support_team == ""TRUE""#(lf)    and is_support_squad == ""TRUE""#(lf)    and has_ticket_within_two_years == ""TRUE""#(lf)| join kind=leftouter (#(lf)    user_dim#(lf)    | project zendesk_user_id, user_handle#(lf)) on $left.author_zendesk_id == $right.zendesk_user_id#(lf)| join kind=leftouter (#(lf)    ticket_fact#(lf)    | project ticket_id, assignee_zendesk_id#(lf)) on $left.ticket_id == $right.ticket_id#(lf)| project #(lf)    comment_id,#(lf)    ticket_id,#(lf)    author_zendesk_id,#(lf)    [""author_handle""] = user_handle,#(lf)    [""Ticket Comment At""] = comment_created_at,#(lf)    [""Ticket Comment Date""] = comment_created_date,#(lf)    assignee_zendesk_id,#(lf)    [""Is Commented by Assignee""] = iff(author_zendesk_id == assignee_zendesk_id, 1, 0)#(lf)", [MaxRows=null, MaxSize=null, NoTruncate=null, AdditionalSetStatements=null])
				in
				    Source

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

